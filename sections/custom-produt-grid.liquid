{% stylesheet %}
  .product-grid {
    display: grid;
    grid-template-columns: repeat(3, 1fr);
    gap: 20px;
    padding-inline: 20px;
  }
  @media(max-width: 749px) {
    .product-grid {
      grid-template-columns: repeat(2, 1fr);
    }
  }
  .product-card {
    position: relative;
    aspect-ratio: 1 / 1;
  }
  .hotspot {
    position: absolute;
    width: 32px;
    height: 32px;
    background: #F8F8F8E5;
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 20px;
    font-weight: bold;
    color: black;
    cursor: pointer;
    transition: all 0.3s ease;
  }

  .hotspot svg {
    pointer-events: none;
  }

  .product-card {
    max-width: 443px;
    overflow: hidden;
  }

  .product-card img {
    object-fit: cover;
  }

  product-quickview:has(.product-popup.active) {
    position: fixed;
    inset: 0;
    display: flex;
    justify-content: center;
    align-items: center;
    backdrop-filter: brightness(0.7);
  }

  product-quickview .product-popup {
    display: none;
    background-color: #ffffff;
    padding: 20px;
  }

  product-quickview .product-popup.active {
    display: block;
  }

  body:has(.product-popup.active) {
    overflow-y: clip;
  }

  h2.product-grid-head {
    font-weight: 400;
    padding-inline: 20px;
    font-size: 36px;
    line-height: 120%;
    letter-spacing: 0;
    margin-bottom: 15px;
  }

{% endstylesheet %}

<h2 class="page-width product-grid-head">{{ section.settings.section_head }}</h2>
<div class="product-grid page-width">
  {% for block in section.blocks %}
    {% assign product = all_products[block.settings.product] %}
    {% if product %}
      <div class="product-card">
        <img
          src="{{ product.featured_image | img_url: '600x' }}"
          alt="{{ product.title }}"
          width="100%"
          height="100%">

        <!-- Hotspot button -->
        <div
          class="hotspot"
          style="top: {{ block.settings.hotspot_top }}%; left: {{ block.settings.hotspot_left }}%;"
          data-product-handle="{{ product.handle }}">
          {% render 'icons' icon: 'plus' %}
        </div>
      </div>
    {% endif %}
  {% endfor %}
</div>

<!-- One global quickview element -->
<product-quickview id="productQuickview">
  <div class="product-popup">
    <div class="product-popup-content">
      <button class="popup-close">{% render 'icons' icon: 'cross' %}</button>
      <div class="popup-body"></div>
    </div>
  </div>
</product-quickview>

{% schema %}
  {
    "name": "Product Grid with Hotspot",
    "settings": [
      {
        "type": "text",
        "id": "section_head",
        "label": "Section head"
      }
    ],
    "blocks": [
      {
        "type": "product",
        "name": "Product",
        "settings": [
          {
            "type": "product",
            "id": "product",
            "label": "Choose product"
          }, {
            "type": "range",
            "id": "hotspot_top",
            "min": 0,
            "max": 100,
            "step": 1,
            "unit": "%",
            "label": "Hotspot Top Position",
            "default": 50
          }, {
            "type": "range",
            "id": "hotspot_left",
            "min": 0,
            "max": 100,
            "step": 1,
            "unit": "%",
            "label": "Hotspot Left Position",
            "default": 50
          }
        ]
      }
    ],
    "presets": [
      {
        "name": "Hotspot Product Grid",
        "category": "Products"
      }
    ]
  }
{% endschema %}